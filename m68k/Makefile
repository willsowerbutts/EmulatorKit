MUSASHIFILES     = m68kcpu.c m68kdasm.c softfloat/softfloat.c softfloat/softfloat_fpsp.c
MUSASHIGENCFILES = m68kops.c
MUSASHIGENHFILES = m68kops.h
MUSASHIGENERATOR = m68kmake

.CFILES   = $(MUSASHIFILES) $(MUSASHIGENCFILES)
.OFILES   = $(.CFILES:%.c=%.o)

.CFILEST   = $(MUSASHIFILES) $(MUSASHIGENCFILES)
.OFILEST   = $(.CFILEST:%.c=%.o)

CC        = gcc -O3
WARNINGS  = -Wall -Wextra -pedantic -Werror
CFLAGS    = $(WARNINGS)
LFLAGS    = $(WARNINGS)

TARGET	  = lib68k.a

DELETEFILES = $(MUSASHIGENCFILES) $(MUSASHIGENHFILES) $(.OFILES) $(.OFILEST) $(TARGET) $(MUSASHIGENERATOR) *~

all: lib68k.a

clean:
	rm -f $(DELETEFILES)

lib68k.a: $(MUSASHIGENHFILES) $(.OFILES) Makefile
	ar rc lib68k.a $(.OFILES)
	ranlib lib68k.a

$(MUSASHIGENCFILES) $(MUSASHIGENHFILES): $(MUSASHIGENERATOR)
	./$(MUSASHIGENERATOR)

$(MUSASHIGENERATOR):  $(MUSASHIGENERATOR).c
	$(CC) -o  $(MUSASHIGENERATOR)  $(MUSASHIGENERATOR).c
